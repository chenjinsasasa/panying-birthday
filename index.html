<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæ—¥å¿«ä¹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        #canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }

        .content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: #fff;
            animation: fadeIn 3s ease-in-out;
        }

        .title-container {
            position: relative;
            margin-bottom: 2rem;
        }

        .birthday-text {
            font-size: 4rem;
            font-weight: bold;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            display: inline-block;
            margin: 0 10px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
            animation: bounce 2s ease-in-out infinite;
            transform-origin: center bottom;
        }

        .char-1 { color: #ff6b9d; animation-delay: 0s; }
        .char-2 { color: #4ecdc4; animation-delay: 0.1s; }
        .char-3 { color: #45b7d1; animation-delay: 0.2s; }
        .char-4 { color: #feca57; animation-delay: 0.3s; }

        .hbd-text {
            font-size: 3rem;
            font-weight: bold;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            display: inline-block;
            margin: 0 5px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
            animation: wiggle 1.5s ease-in-out infinite;
        }

        .hbd-h { color: #ffd93d; }
        .hbd-b { color: #ff6b9d; }
        .hbd-d { color: #a8e6cf; }

        .crown {
            position: absolute;
            top: -30px;
            left: -20px;
            font-size: 2.5rem;
            animation: float 3s ease-in-out infinite;
        }

        .cake {
            position: absolute;
            bottom: -40px;
            right: -30px;
            font-size: 3rem;
            animation: rotate 4s linear infinite;
        }

        .subtitle {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            color: #ff69b4;
            text-shadow: 0 0 10px rgba(255, 105, 180, 0.6);
        }

        .message {
            font-size: 1.2rem;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
            padding: 0 20px;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }

        .music-control {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 3;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            color: #fff;
            font-size: 1.5rem;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .music-control:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0) scale(1); }
            40% { transform: translateY(-20px) scale(1.1); }
            60% { transform: translateY(-10px) scale(1.05); }
        }

        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(-5deg) scale(1.05); }
            75% { transform: rotate(5deg) scale(1.05); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(10deg); }
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            .birthday-text {
                font-size: 2.5rem;
            }
            .hbd-text {
                font-size: 2rem;
            }
            .crown {
                font-size: 2rem;
                top: -20px;
                left: -15px;
            }
            .cake {
                font-size: 2.5rem;
                bottom: -30px;
                right: -20px;
            }
            .subtitle {
                font-size: 1.5rem;
            }
            .message {
                font-size: 1rem;
                padding: 0 15px;
            }
            .music-control {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
        }

        @media (max-width: 480px) {
            .birthday-text {
                font-size: 2rem;
            }
            .hbd-text {
                font-size: 1.5rem;
            }
            .crown {
                font-size: 1.5rem;
                top: -15px;
                left: -10px;
            }
            .cake {
                font-size: 2rem;
                bottom: -25px;
                right: -15px;
            }
            .subtitle {
                font-size: 1.2rem;
            }
            .message {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <div class="content">
        <div class="title-container">
            <div class="crown">ğŸ‘‘</div>
            <div>
                <span class="birthday-text char-1">ç”Ÿ</span>
                <span class="birthday-text char-2">æ—¥</span>
                <span class="birthday-text char-3">å¿«</span>
                <span class="birthday-text char-4">ä¹</span>
            </div>
            <div style="margin-top: 10px;">
                <span class="hbd-text hbd-h">P</span>
                <span class="hbd-text hbd-b">Y</span>
            </div>
            <div class="cake">ï¿½</div>
        </div>
        <h2 class="subtitle">ğŸ‚ ç¥æ½˜è¿ç”Ÿæ—¥å¿«ä¹ ï¿½</h2>
        <div class="message">
            <p>ğŸˆ æ„¿ä½ çš„æ¯ä¸€å¤©éƒ½å……æ»¡é˜³å…‰ä¸å¿«ä¹</p>
            <p>âœ¨ æ„¿ä½ æ‰€æœ‰çš„æ¢¦æƒ³éƒ½èƒ½æˆçœŸ</p>
            <p>ğŸ æ„¿ä½ æ°¸è¿œå¹´è½»ç¾ä¸½ï¼Œç¬‘å®¹ç¿çƒ‚</p>
            <p>ğŸ’– ç¥ä½ ç”Ÿæ—¥å¿«ä¹ï¼Œå¤©å¤©å¼€å¿ƒï¼</p>
        </div>
    </div>

    <button class="music-control" id="musicBtn" onclick="toggleMusic()">ğŸµ</button>

    <audio id="bgMusic" loop preload="auto">
        <!-- æœ¬åœ°ç”Ÿæ—¥å¿«ä¹æ­Œæ›²ï¼ˆé¦–é€‰ï¼‰ -->
        <source src="ç”Ÿæ—¥å¿«ä¹æ­Œæ›².mp3" type="audio/mpeg">
        <!-- å¤‡ç”¨è¿œç¨‹éŸ³ä¹æº -->
        <source src="https://www.learningcontainer.com/wp-content/uploads/2020/02/Kalimba.mp3" type="audio/mpeg">
        <source src="https://file-examples.com/storage/fe68c8a7d4e2187c8d8b4e6/2017/11/file_example_MP3_700KB.mp3" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾
    </audio>

    <!-- å¤‡ç”¨éŸ³ä¹æ’­æ”¾å™¨ -->
    <audio id="bgMusic2" loop preload="auto" style="display: none;">
        <!-- ç®€å•çš„éŸ³é¢‘æ•°æ®ï¼Œç¡®ä¿æœ‰å£°éŸ³ -->
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
    </audio>

    <!-- éŸ³ä¹çŠ¶æ€æç¤º -->
    <div id="musicStatus" style="position: fixed; top: 80px; right: 20px; z-index: 3; background: rgba(0,0,0,0.7); color: white; padding: 10px; border-radius: 5px; font-size: 12px; display: none; max-width: 200px;">
        æ­£åœ¨åŠ è½½éŸ³ä¹...
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const musicBtn = document.getElementById('musicBtn');
        const bgMusic = document.getElementById('bgMusic');
        const bgMusic2 = document.getElementById('bgMusic2');
        const musicStatus = document.getElementById('musicStatus');

        let isPlaying = false;
        let currentMusic = bgMusic;
        let fireworks = [];
        let particles = [];
        let lastFireworkTime = 0; // ä¸Šæ¬¡åˆ›å»ºçƒŸèŠ±çš„æ—¶é—´
        let minFireworkInterval = 1000; // æœ€å°çƒŸèŠ±é—´éš”ï¼ˆæ¯«ç§’ï¼‰
        let maxFireworks = 8; // å±å¹•ä¸Šæœ€å¤§çƒŸèŠ±æ•°é‡

        // æ˜¾ç¤ºéŸ³ä¹çŠ¶æ€æç¤º
        function showMusicStatus(message, duration = 3000) {
            musicStatus.textContent = message;
            musicStatus.style.display = 'block';

            if (duration > 0) {
                setTimeout(() => {
                    musicStatus.style.display = 'none';
                }, duration);
            }
        }

        // ç”Ÿæ—¥ç¥ç¦éŸ³ä¹åˆ—è¡¨ï¼ˆæœ¬åœ°æ–‡ä»¶ä¼˜å…ˆï¼‰
        const musicSources = [
            // æœ¬åœ°ç”Ÿæ—¥å¿«ä¹æ­Œæ›²ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
            'ç”Ÿæ—¥å¿«ä¹æ­Œæ›².mp3',
            // å¤‡ç”¨è¿œç¨‹éŸ³ä¹èµ„æº
            'https://www.learningcontainer.com/wp-content/uploads/2020/02/Kalimba.mp3',
            'https://file-examples.com/storage/fe68c8a7d4e2187c8d8b4e6/2017/11/file_example_MP3_700KB.mp3',
            'https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3',
            'https://www.soundjay.com/misc/sounds/magic-chime-02.mp3',
            // æ›´å¤šå¤‡ç”¨éŸ³ä¹æº
            'https://actions.google.com/sounds/v1/celebrations/birthday_party_horn.ogg',
            'https://freesound.org/data/previews/316/316847_5123451-lq.mp3',
            // å¦‚æœä¸Šè¿°éƒ½å¤±è´¥ï¼Œä½¿ç”¨åŸæ¥çš„éŸ³ä¹æº
            'http://dlb.888dly.vip/174/static/music/happy_birthday.mp3'
        ];

        let currentSourceIndex = 0;

        // è®¾ç½®ç”»å¸ƒå¤§å°
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // å°è¯•åŠ è½½ä¸‹ä¸€ä¸ªéŸ³ä¹æº
        function tryNextMusicSource() {
            if (currentSourceIndex < musicSources.length) {
                const currentSource = musicSources[currentSourceIndex];
                console.log(`å°è¯•æ’­æ”¾éŸ³ä¹æº ${currentSourceIndex + 1}/${musicSources.length}: ${currentSource}`);

                currentMusic.src = currentSource;
                currentSourceIndex++;

                // æ·»åŠ åŠ è½½äº‹ä»¶ç›‘å¬
                return new Promise((resolve, reject) => {
                    const onCanPlay = () => {
                        const isLocalMusic = currentSource.includes('ç”Ÿæ—¥å¿«ä¹æ­Œæ›².mp3');
                        const message = isLocalMusic ? 'ğŸµ ç”Ÿæ—¥å¿«ä¹æ­Œæ›²åŠ è½½æˆåŠŸ' : 'ğŸµ éŸ³ä¹åŠ è½½æˆåŠŸ';
                        console.log(message + 'ï¼Œå¼€å§‹æ’­æ”¾');
                        currentMusic.removeEventListener('canplay', onCanPlay);
                        currentMusic.removeEventListener('error', onError);
                        currentMusic.play().then(resolve).catch(reject);
                    };

                    const onError = (e) => {
                        console.log(`éŸ³ä¹æº ${currentSourceIndex} åŠ è½½å¤±è´¥:`, e);
                        currentMusic.removeEventListener('canplay', onCanPlay);
                        currentMusic.removeEventListener('error', onError);
                        tryNextMusicSource().then(resolve).catch(reject);
                    };

                    currentMusic.addEventListener('canplay', onCanPlay);
                    currentMusic.addEventListener('error', onError);

                    // è®¾ç½®è¶…æ—¶
                    setTimeout(() => {
                        console.log(`éŸ³ä¹æº ${currentSourceIndex} åŠ è½½è¶…æ—¶`);
                        onError(new Error('åŠ è½½è¶…æ—¶'));
                    }, 5000);

                    currentMusic.load();
                });
            } else {
                console.log('æ‰€æœ‰éŸ³ä¹æºéƒ½æ— æ³•æ’­æ”¾ï¼Œä½¿ç”¨å¤‡ç”¨éŸ³ä¹');
                currentMusic = bgMusic2;
                return currentMusic.play().catch(e => {
                    console.log('å¤‡ç”¨éŸ³ä¹ä¹Ÿæ— æ³•æ’­æ”¾:', e);
                    // åˆ›å»ºç®€å•çš„éŸ³æ•ˆ
                    createSimpleBeep();
                    return Promise.resolve();
                });
            }
        }

        // åˆ›å»ºç®€å•çš„ç”Ÿæ—¥æ­ŒéŸ³æ•ˆï¼ˆå½“æ‰€æœ‰éŸ³ä¹éƒ½æ— æ³•æ’­æ”¾æ—¶ï¼‰
        function createSimpleBeep() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();

                // ç”Ÿæ—¥æ­Œçš„ç®€å•æ—‹å¾‹ (Happy Birthday to You)
                const notes = [
                    {freq: 261.63, duration: 0.5}, // C4
                    {freq: 261.63, duration: 0.5}, // C4
                    {freq: 293.66, duration: 1.0}, // D4
                    {freq: 261.63, duration: 1.0}, // C4
                    {freq: 349.23, duration: 1.0}, // F4
                    {freq: 329.63, duration: 2.0}, // E4
                ];

                let currentTime = audioContext.currentTime;

                notes.forEach((note, index) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.frequency.setValueAtTime(note.freq, currentTime);
                    oscillator.type = 'sine';

                    gainNode.gain.setValueAtTime(0, currentTime);
                    gainNode.gain.linearRampToValueAtTime(0.3, currentTime + 0.1);
                    gainNode.gain.linearRampToValueAtTime(0, currentTime + note.duration);

                    oscillator.start(currentTime);
                    oscillator.stop(currentTime + note.duration);

                    currentTime += note.duration;
                });

                console.log('æ’­æ”¾ç®€å•ç”Ÿæ—¥æ­ŒéŸ³æ•ˆ');

            } catch (error) {
                console.log('æ— æ³•åˆ›å»ºéŸ³æ•ˆ:', error);
            }
        }

        // éŸ³ä¹æ§åˆ¶
        function toggleMusic() {
            if (isPlaying) {
                currentMusic.pause();
                musicBtn.textContent = 'ğŸµ';
                musicBtn.style.opacity = '0.6';
                musicBtn.title = 'ç‚¹å‡»æ’­æ”¾éŸ³ä¹';
                isPlaying = false;
                showMusicStatus('éŸ³ä¹å·²æš‚åœ');
                console.log('éŸ³ä¹å·²æš‚åœ');
            } else {
                musicBtn.textContent = 'ğŸ”„';
                musicBtn.style.opacity = '0.8';
                musicBtn.title = 'æ­£åœ¨åŠ è½½éŸ³ä¹...';
                showMusicStatus('æ­£åœ¨åŠ è½½éŸ³ä¹...', 0);
                console.log('å¼€å§‹å°è¯•æ’­æ”¾éŸ³ä¹');

                // é‡ç½®éŸ³ä¹æºç´¢å¼•ï¼Œä»ç¬¬ä¸€ä¸ªå¼€å§‹å°è¯•
                currentSourceIndex = 0;

                tryNextMusicSource().then(() => {
                    musicBtn.textContent = 'ğŸ”Š';
                    musicBtn.style.opacity = '1';
                    musicBtn.title = 'ç‚¹å‡»æš‚åœéŸ³ä¹';
                    isPlaying = true;

                    // æ£€æŸ¥æ˜¯å¦æ’­æ”¾çš„æ˜¯æœ¬åœ°ç”Ÿæ—¥æ­Œæ›²
                    const isLocalMusic = currentMusic.src.includes('ç”Ÿæ—¥å¿«ä¹æ­Œæ›².mp3');
                    const statusMessage = isLocalMusic ? 'ğŸ‚ ç”Ÿæ—¥å¿«ä¹æ­Œæ›²æ’­æ”¾ä¸­' : 'ğŸµ éŸ³ä¹æ’­æ”¾ä¸­';
                    showMusicStatus(statusMessage);
                    console.log('éŸ³ä¹æ’­æ”¾æˆåŠŸ');
                }).catch((error) => {
                    musicBtn.textContent = 'âŒ';
                    musicBtn.style.opacity = '0.6';
                    musicBtn.title = 'éŸ³ä¹æ’­æ”¾å¤±è´¥ï¼Œç‚¹å‡»é‡è¯•';
                    isPlaying = false;
                    showMusicStatus('âŒ éŸ³ä¹æ’­æ”¾å¤±è´¥ï¼Œå·²æ’­æ”¾éŸ³æ•ˆ', 5000);
                    console.log('éŸ³ä¹æ’­æ”¾å¤±è´¥:', error);

                    // 3ç§’åæ¢å¤æŒ‰é’®çŠ¶æ€
                    setTimeout(() => {
                        musicBtn.textContent = 'ğŸµ';
                        musicBtn.title = 'ç‚¹å‡»æ’­æ”¾éŸ³ä¹';
                    }, 3000);
                });
            }
        }

        // éŸ³ä¹åŠ è½½é”™è¯¯å¤„ç†
        bgMusic.addEventListener('error', function() {
            console.log('ä¸»éŸ³ä¹åŠ è½½å¤±è´¥ï¼Œå°è¯•ä¸‹ä¸€ä¸ªæº');
            tryNextMusicSource();
        });

        bgMusic2.addEventListener('error', function() {
            console.log('å¤‡ç”¨éŸ³ä¹åŠ è½½å¤±è´¥');
        });

        // è‡ªåŠ¨æ’­æ”¾éŸ³ä¹ï¼ˆéœ€è¦ç”¨æˆ·äº¤äº’ï¼‰
        document.addEventListener('click', function() {
            if (!isPlaying) {
                toggleMusic();
            }
        }, { once: true });

        // ç¤¼èŠ±ç²’å­ç±»
        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                // å¢åŠ ç²’å­é€Ÿåº¦å’Œæ‰©æ•£èŒƒå›´
                this.vx = (Math.random() - 0.5) * 16;
                this.vy = (Math.random() - 0.5) * 16;
                this.color = color;
                this.life = 1;
                this.decay = Math.random() * 0.012 + 0.006; // ä¼˜åŒ–ç”Ÿå‘½å‘¨æœŸï¼Œè®©çƒŸèŠ±æŒç»­æ›´ä¹…
                this.size = Math.random() * 5 + 2; // å¢åŠ ç²’å­å¤§å°
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.vy += 0.1; // é‡åŠ›
                this.life -= this.decay;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.life;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }

        // æ•°å­—ç¤¼èŠ±ç±»
        class NumberFirework {
            constructor(x, y, number) {
                this.x = x;
                this.y = y;
                this.number = number;
                this.particles = [];
                this.colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3', '#54a0ff'];
                this.exploded = false;
                this.timer = 0;
            }

            explode() {
                if (this.exploded) return;
                this.exploded = true;

                // ä¼˜åŒ–ç²’å­æ•°é‡ï¼Œå¹³è¡¡è§†è§‰æ•ˆæœå’Œæ€§èƒ½
                const particleCount = 60;
                for (let i = 0; i < particleCount; i++) {
                    const color = this.colors[Math.floor(Math.random() * this.colors.length)];
                    const particle = new Particle(this.x, this.y, color);
                    this.particles.push(particle);
                }
            }

            update() {
                this.timer++;
                // å¯¹äºå±å¹•ä¸­é—´çš„çƒŸèŠ±ï¼Œç«‹å³çˆ†ç‚¸ï¼›å¯¹äºåº•éƒ¨çš„çƒŸèŠ±ï¼Œç­‰å¾…ä¸Šå‡
                const shouldExplodeImmediately = this.y < canvas.height * 0.9;
                const explodeTime = shouldExplodeImmediately ? 10 : 60;

                if (this.timer > explodeTime && !this.exploded) {
                    this.explode();
                }

                this.particles = this.particles.filter(particle => {
                    particle.update();
                    return particle.life > 0;
                });
            }

            draw() {
                if (!this.exploded) {
                    // ç»˜åˆ¶ä¸Šå‡çš„æ•°å­—
                    ctx.save();
                    ctx.fillStyle = '#fff';
                    ctx.font = 'bold 30px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(this.number, this.x, this.y - this.timer * 2);
                    ctx.restore();
                }

                this.particles.forEach(particle => particle.draw());
            }
        }

        // åˆ›å»ºç¤¼èŠ±ï¼ˆå¸¦æ—¶é—´é—´éš”å’Œæ•°é‡æ§åˆ¶ï¼‰
        function createFirework() {
            const currentTime = Date.now();
            if (currentTime - lastFireworkTime < minFireworkInterval || fireworks.length >= maxFireworks) {
                return; // å¦‚æœé—´éš”å¤ªçŸ­æˆ–çƒŸèŠ±å¤ªå¤šï¼Œä¸åˆ›å»ºæ–°çƒŸèŠ±
            }

            // åœ¨æ•´ä¸ªå±å¹•èŒƒå›´å†…éšæœºç”ŸæˆçƒŸèŠ±
            const x = Math.random() * canvas.width;
            const y = Math.random() * canvas.height * 0.8; // é¿å…åœ¨æœ€åº•éƒ¨20%ç”Ÿæˆ
            const numbers = ['ğŸ‚', 'ğŸ‰', 'ğŸˆ', 'ğŸŒŸ', 'ğŸ’–', 'ğŸ', 'âœ¨', 'ğŸŠ', 'ğŸ¥³', 'ğŸˆ'];
            const number = numbers[Math.floor(Math.random() * numbers.length)];
            fireworks.push(new NumberFirework(x, y, number));
            lastFireworkTime = currentTime;
        }

        // åˆ›å»ºä»åº•éƒ¨ä¸Šå‡çš„ç¤¼èŠ±ï¼ˆä¼ ç»ŸçƒŸèŠ±æ•ˆæœï¼‰
        function createRisingFirework() {
            const currentTime = Date.now();
            if (currentTime - lastFireworkTime < minFireworkInterval * 0.8 || fireworks.length >= maxFireworks) {
                return; // ç¨å¾®çŸ­ä¸€ç‚¹çš„é—´éš”ï¼ŒåŒæ ·æ£€æŸ¥æ•°é‡é™åˆ¶
            }

            const x = Math.random() * canvas.width;
            const y = canvas.height;
            const numbers = ['ğŸ†', 'âœ¨', 'ğŸ’«'];
            const number = numbers[Math.floor(Math.random() * numbers.length)];
            fireworks.push(new NumberFirework(x, y, number));
            lastFireworkTime = currentTime;
        }

        // åŠ¨ç”»å¾ªç¯
        function animate() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // æ›´æ–°å’Œç»˜åˆ¶ç¤¼èŠ±
            fireworks = fireworks.filter(firework => {
                firework.update();
                firework.draw();
                return firework.particles.length > 0 || !firework.exploded;
            });

            // éšæœºåˆ›å»ºæ–°ç¤¼èŠ± - è¿›ä¸€æ­¥ä¼˜åŒ–é¢‘ç‡ï¼Œæ›´ä¼˜é›…
            if (Math.random() < 0.015) {
                createFirework(); // åœ¨å±å¹•ä»»æ„ä½ç½®åˆ›å»ºçƒŸèŠ±
            }

            // å¶å°”åˆ›å»ºä»åº•éƒ¨ä¸Šå‡çš„ä¼ ç»ŸçƒŸèŠ±
            if (Math.random() < 0.008) {
                createRisingFirework();
            }

            requestAnimationFrame(animate);
        }

        // å¼€å§‹åŠ¨ç”»
        animate();

        // åˆå§‹ç¤¼èŠ± - ä¼˜åŒ–æ•°é‡å’Œæ—¶é—´é—´éš”
        setTimeout(() => {
            // åˆ›å»ºé€‚é‡çƒŸèŠ±åœ¨ä¸åŒä½ç½®ï¼Œé—´éš”æ›´é•¿
            for (let i = 0; i < 3; i++) {
                setTimeout(() => createFirework(), i * 800);
            }
            // åˆ›å»ºä¸€äº›ä»åº•éƒ¨ä¸Šå‡çš„çƒŸèŠ±
            for (let i = 0; i < 2; i++) {
                setTimeout(() => createRisingFirework(), i * 1200 + 1500);
            }
        }, 1500);
    </script>
</body>
</html>